{{- $text := .Get "text" | default "Get Deal â†’" -}}
{{- $url := .Get "url" -}}
{{- $slug := .Get "slug" -}}
{{- $class := .Get "class" | default "aff-button" -}}
{{- $target := .Get "target" | default "_blank" -}}
{{- $tracking := .Get "tracking" -}}

{{- if $slug -}}
  {{- $redirects := .Site.Data.redirects -}}
  {{- $url = index $redirects $slug -}}
{{- end -}}

{{- if $url -}}
<a href="/go/{{ $slug }}" class="{{ $class }}" target="{{ $target }}" rel="nofollow sponsored">
  <span class="button-text">{{ $text }}</span>
  <svg class="button-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  {{- if $tracking }}
  <img src="{{ $tracking }}" alt="" style="display:none;" aria-hidden="true">
  {{- end }}
</a>
{{- else -}}
<!-- Affiliate button error: no URL found for slug "{{ $slug }}" -->
{{- end -}}